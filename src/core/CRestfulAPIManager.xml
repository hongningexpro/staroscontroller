<?xml version="1.0" encoding="UTF-8"?>
<starlang xmlns="http://www.staros.xyz/starcore/xml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" scope="application">
	<!--Restful API Service-->
	<class name="CRestfulAPIEntry">
		<private>
			<long name="m_bundleid"  />
			<string name="m_eventname"  />
			<string name="m_restfullurl"  />
		</private>
		<public>
			<function name="CRestfulAPIEntry">
				<parameters>
					<long name="bundleid" />			
					<string name="eventname" />
					<string name="restfullurl" />			
				</parameters>
				<set name="thisclass.m_bundleid" value="context.bundleid.toLong()"/>
				<set name="thisclass.m_eventname" value="context.eventname.toString()"/>
				<set name="thisclass.m_restfullurl" value="context.restfullurl.toString()"/>
			</function>
			
			<!--qiulei 20170824 pm-->
			<function name="GetAPIInfo">
				<parameters>
					<!--return eventname-->
					<string name="eventname" />
					<!--return bundleid-->
					<long name="bundleid"/>
				</parameters>
				<set name="eventname" value="thisclass.m_eventname"/>
					<set name="bundleid" value="thisclass.m_bundleid"/>
				</function>
			
		</public>
	</class>
	<class name="CRestfulAPIManager">
		<private>
			<hashmap name="restfulapiContainer"  keytype="string" valuetype="object"/>
		</private>
		<public>

			<function name="CRestfulAPIManager">
				<log>CRestfulAPIManager is create</log>
			</function>
			<function name="AddAPIHandler">
				<parameters>
					<string name="requestpath2222"/>			
					<object name="handler"/>			
				</parameters>
				<if cond="thisclass.restfulapiContainer.hasValue(context.requestpath2222.toString())==false">
					<then>
						<insert name="thisclass.restfulapiContainer" key="context.requestpath2222.toString()" value="context.handler"/>
					</then>
				</if>				
				
			</function>
			
			<function name="RemoveAPIHandler">
					<parameters>
						<string name="requestpath"  />		
					</parameters>
				<remove name="thisclass.restfulapiContainer" key="context.requestpath.toString()"/>
			</function>
			<!--hu-->
			<function name="GetHandler">
				<parameters>
					<string name="requestpath" />
					<object name="handler" />
				</parameters>
				<string name="requestpaths2222" />
				<boolean name="ispath" />
				<pair name="onerestfulpair"  keytype="string" valuetype="object"/>
				<for var="onerestfulpair" in="context.restfulapiContainer">
					<set name="requestpaths2222" value="context.onerestfulpair.first()"/>
					<script><![CDATA[
						var requestpaths=context.requestpath.toString();

							if(requestpaths.indexOf(context.requestpaths2222.toString())>=0){
								context.ispath.setValue(true);
							}else{
								context.ispath.setValue(false);
						}			
					]]></script>	
					<if cond="context.ispath.toBoolean()==true">
						<then>						
							<set name="handler" value="thisclass.restfulapiContainer.getValue(context.requestpaths2222.toString())"/>
						</then>
					</if>
				</for>
			</function>
		</public>
	</class>
</starlang>