<?xml version="1.0" encoding="UTF-8"?>
<starosxml xmlns="http://www.staros.xyz/starcore/xml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" scope="application">
	<!--Restful API Service-->
	<class name="CRestfulAPIEntry">
		<private>
			<variable name="m_bundleid" type="long" />
			<variable name="m_eventname" type="string" />
			<variable name="m_restfullurl" type="string" />
		</private>
		<public>
			<function name="CRestfulAPIEntry">
				<parameters>
					<parameter name="bundleid" type="long"/>			
					<parameter name="eventname" type="string"/>
					<parameter name="restfullurl" type="string"/>			
				</parameters>
				<set name="thisclass.m_bundleid" value="context.bundleid.toLong()"/>
				<set name="thisclass.m_eventname" value="context.eventname.toString()"/>
				<set name="thisclass.m_restfullurl" value="context.restfullurl.toString()"/>
			</function>
			
			<!--qiulei 20170824 pm-->
			<function name="GetAPIInfo">
				<parameters>
					<!--return eventname-->
					<parameter name="eventname" type="string"/>
					<!--return bundleid-->
					<parameter name="bundleid" type="long"/>
				</parameters>
				<set name="eventname" value="thisclass.m_eventname"/>
					<set name="bundleid" value="thisclass.m_bundleid"/>
				</function>
			
		</public>
	</class>
	<class name="CRestfulAPIManager">
		<private>
			<container name="restfulapiContainer" type="hashmap" keytype="string" valuetype="class"/>
		</private>
		<public>

			<function name="CRestfulAPIManager">
				<log>CRestfulAPIManager is create</log>
			</function>
			<function name="AddAPIHandler">
				<parameters>
					<parameter name="requestpath2222" type="string"/>			
					<parameter name="handler" type="class"/>			
				</parameters>
				<if cond="thisclass.restfulapiContainer.hasValue(context.requestpath2222.toString())==false">
					<then>
						<insert name="thisclass.restfulapiContainer" key="context.requestpath2222.toString()" value="context.handler"/>
					</then>
				</if>
				<log>restfulapiContainer is true</log>
				
			</function>
			
			<function name="RemoveAPIHandler">
					<parameters>
						<parameter name="requestpath" type="string" />		
					</parameters>
				<remove name="thisclass.restfulapiContainer" key="context.requestpath.toString()"/>
			</function>
			<!--hu-->
			<function name="GetHandler">
				<parameters>
					<parameter name="requestpath" type="string"/>
					<parameter name="handler" type="class"/>
				</parameters>
				<variable name="requestpaths2222" type="string"/>
				<variable name="ispath" type="boolean"/>
				<container name="onerestfulpair" type="pair" keytype="string" valuetype="class"/>
				<for var="onerestfulpair" in="context.restfulapiContainer">
					<set name="requestpaths2222" value="context.onerestfulpair.first()"/>
					<script><![CDATA[
						var requestpaths=context.requestpath.toString();

							if(requestpaths.indexOf(context.requestpaths2222.toString())>=0){
								context.ispath.setValue(true);
							}else{
								context.ispath.setValue(false);
						}			
					]]></script>	
					<log><![CDATA[requestpaths   huhu= <%=context.requestpath.toString()%>]]> </log>
					<log><![CDATA[requestpaths2222   huhu= <%=context.requestpaths2222.toString()%>]]> </log>
					<log><![CDATA[ispath   huhu= <%=context.ispath.toBoolean()%>]]> </log>
					<if cond="context.ispath.toBoolean()==true">
						<then>
							<log>huhuhuhu !!!!true</log>
							<set name="handler" value="thisclass.restfulapiContainer.getValue(context.requestpaths2222.toString())"/>
						</then>
					</if>
				</for>
			</function>
		</public>
	</class>
</starosxml>