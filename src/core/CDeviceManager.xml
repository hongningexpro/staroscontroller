<?xml version="1.0" encoding="UTF-8"?>
<starosxml xmlns="http://www.staros.xyz/starcore/xml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" scope="application">
	<class name="CDeviceManager">
		<private>
			<container name="deviceContainer" type="hashmap" keytype="string" valuetype="class"/>
		</private>
		
		<public>
			<function name="addDevice">
				<parameters>
					<parameter name="datapathid" type="string"/>
					<parameter name="deviceobject" type="hashmap"/>			
				</parameters>
				<insert name="deviceContainer" key="context.datapathid.toString()" value="context.deviceobject"/>
			</function>
				
			<function name="findDevice">
				<parameters>
					<parameter name="datapathid" type="string"/>
					<parameter name="deviceobject" type="hashmap"/>
				</parameters>
				<container name="deviceinfo" type="hashmap" keytype="string" valuetype="string"/>
				<if cond="context.deviceContainer.hasValue(datapathid)==true">
					<then>
						<function>
							<lookup name="deviceContainer" key="context.datapathid.toString()" output="context.deviceinfo"/>
						</function>
					</then>
				</if>
				<set name="deviceobject" value="context.deviceinfo"/>
			</function>
			
			<function name="removeDevice">
				<parameters>
					<parameter name="datapathid" type="string"/>
				</parameters>
				<remove name="deviceContainer" key="context.datapathid.toString()"/>
			</function>
			<function name="GetTransportIdFromDevice">
				<parameters>
					<parameter name="datapathid" type="string"/>
					<parameter name="transportid" type="string"/>
				</parameters>
				<container name="deviceinfo" type="hashmap" keytype="string" valuetype="string"/>
				<for var="i" from="0" to="context.deviceContainer.size()-1">
					<function>
						<set name="deviceinfo" value="context.deviceContainer.getValueByIndex(context.i.toLong())"/>
						<if cond="context.deviceinfo.getValue('datapathid').toString() == context.datapathid.toString()">
							<then>
								<set name="transportid" value="context.deviceinfo.getValue('transportid').toString()"/>
								<exit/>
							</then>
						</if>
					</function>
				</for>
			</function>
			<function name="removeDeviceByTransportId">
				<parameters>
					<parameter name="transportid" type="string"/>
				</parameters>
				<container name="deviceinfo" type="hashmap" keytype="string" valuetype="string"/>
				<variable name="datapathid" type="string"/>
				<for var="i" from="0" to="context.deviceContainer.size()-1">
					<function>			
						<set name="deviceinfo" value="context.deviceContainer.getValueByIndex(context.i.toLong())"/>
						<if cond="context.deviceinfo.getValue('transportid').toString() == context.transportid.toString()">
							<then>
								<set name="datapathid" value="context.deviceinfo.getValue('datapathid').toString()"/>
							</then>
						</if>
					</function>
				</for>
				<remove name="deviceContainer" key="context.datapathid.toString()"/>
			</function>
		
		</public>
	</class>
</starosxml>