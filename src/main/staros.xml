<?xml version="1.0" encoding="UTF-8"?>
<!--StarOS Entry-->
<starosxml xmlns="http://www.staros.xyz/starcore/xml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" scope="application">
	<include src="/opt/staros.xyz/staroscontroller/starlang/utils/function_callback.xml"/>
	<include src="/opt/staros.xyz/staroscontroller/starlang/restfulapi/staros_api_map.xml"/>
	<include src="/opt/staros.xyz/staroscontroller/starlang/websocket/staros_websocket_map.xml"/>
	<include src="/opt/staros.xyz/staroscontroller/starlang/gui/staros_onos_gui.xml"/>
	<include src="/opt/staros.xyz/staroscontroller/starlang/openflow/openflow_app.xml"/>
	<include src="/opt/staros.xyz/staroscontroller/starlang/openflow/openflow_topology.xml"/>
	<include src="/opt/staros.xyz/staroscontroller/starlang/setting/setting.xml"/>
	<!--qiulei 20170811-->
	<include src="/opt/staros.xyz/staroscontroller/starlang/localcall/localcall.xml"/>
	<include src="/opt/staros.xyz/staroscontroller/starlang/resource/global_resource.xml"/>
	<include src="/opt/staros.xyz/staroscontroller/starlang/utils/define.xml"/>
	<include src="/opt/staros.xyz/staroscontroller/starlang/utils/utils.xml"/>
	<include src="/opt/staros.xyz/staroscontroller/starlang/utils/oxm_match_fields_map.xml"/>
	<include src="/opt/staros.xyz/staroscontroller/starlang/utils/actions_map.xml"/>
	<include src="/opt/staros.xyz/staroscontroller/starlang/utils/instrunction_map.xml"/>
	<include src="/opt/staros.xyz/staroscontroller/starlang/utils/group_type_map.xml"/>
	<variable name="openflowserverobj" type="object" global="true"/>
	<variable name="restfulserver" type="object" global="true"/>

	<logconfig dest="stdout|file" filename="/opt/staros.xyz/staroscontroller/logs/starosapps.log" logturnoff="false"/>
	<events>
		<!--Session StarUp-->
		<onevent event="bundleapp.startup">
		  <variable name="calloutSession" type="long"/>
		  <variable name="outjson" type="string"/>
		  <variable name="injson" type="string"/>
		  <!--qiulei 20170828 Monday-->
		  <variable name="eventname" type="string"/>
		  <function>
			<set name="injson" value="'[]'"/>
			<log>##########STAROS application start#######</log>
			<localcall method="hellotest" inparam="context.injson" outparam="context.outjson"/>
			<log><![CDATA[ localcall output value <%=context.outjson.toString()%>]]></log>
			<remotecall method="DiscoveryTestMethod">
					<applicationdata>
						<![CDATA[ 
						hello world;
						]]>
					</applicationdata>
			</remotecall>
			<wait event="hellorequest" timeout="1000"/>
			<!--Init Flow Manager -->
			
			<function name="InitGlobalResource"/>
			<function name="InitAPIMapFunction"/>
			<!--hu peng 2017/07/28  change setting-->
			<function name="InitSetting"/>
			<function name="InitWebSocketHandlerMap"/>
			<!--Start GUI and Restful API Service-->
			<function name="Restfulserver"/>
				<!--Start OpenFlow Controller protocol-->
			<function name="startopenflow"/>
			<function name="testcallback"/>
			<!--function name="addhostest"/-->
			<!--function name="startnullapp"/-->
			<!--InitOpenFlow OXM Match Filed Map-->
			<function name="InitOXMMatchFieldMap"/>
			<function name="InitOXMMatchFieldNameMap"/>
			<function name="InitInstrunctionMap"/>
			<function name="InitActionsMap"/>
		  <function name="InitActionsNameMap"/>
		  						<!--qiulei 20170828 Monday-->
			<set name="eventname"  value="'TimeOutEvent'"/>
			<raise name="context.eventname.toString()"/>
			
		  </function>
		</onevent>
		<!--Session Shutdown-->
		<onevent event="~bundleapp.shutdown">
		  <function>
			<log>##########~bundleapp.shutdown#######</log>
		  </function>
		</onevent>
					<!--qiulei 20170828 Monday-->
		<onevent event="TimeOutEvent">
			<function >
				<log>staros TimeOutEvent 2017.08.28</log>
				<wait event="InvalidEvent" timeout="2000"/>
				<function name="OpenFlowDetect"/>
				<function name="Timeout" class="SessionManager"/>
				<raise name="'TimeOutEvent'"/>
			</function>
		</onevent>
	</events>
</starosxml>