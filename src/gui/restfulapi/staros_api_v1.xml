<?xml version="1.0" encoding="UTF-8"?>
<starosxml xmlns="http://www.staros.xyz/starcore" scope="application">
	<include src="/opt/staros.xyz/staroscontroller/starlang/gui/restfulapi/staros_api_device.xml"/>
	<include src="/opt/staros.xyz/staroscontroller/starlang/gui/restfulapi/staros_api_map.xml"/>
	<include src="/opt/staros.xyz/staroscontroller/starlang/gui/restfulapi/staros_api_topology.xml"/>
	<!--WebGUI-->
	<function name="HandlAPIRequest">
		<parameters>
			<parameter name="requestpath" type="string"/>
			<parameter name="method" type="string"/>
			<parameter name="eventdata" type="string"/>
		</parameters>
		<variable name="functionname" type="string"/>
		<variable name="isHaveHandler" type="boolean"/>
		<log>HandleAPI</log>
		<log><![CDATA[HandleAPI request path <%=context.reqestpath.toString()%>]]></log>
		<if cond="global.APIV1MapFunction.hasParam(context.reqestpath) == true">
			<then>
				<function>
					<set name="functionname" value="global.APIV1MapFunction.getParam(context.reqestpath.toString())"/>
					<function callback="functionname">
						<parameters>
							<parameter name="reqestpath" type="string" in="context.reqestpath.toString()"/>
							<parameter name="method" type="string" in="context.method.toString()"/>
							<parameter name="eventdata" type="string" in="context.eventdata.toString()"/>
						</parameters>
					</function>
				</function>
			</then>
			<else>
				<function>
					<function name="HandleAPI" class="RestfulAPIManager">
						<parameters>
							<parameter name="reqestpath" type="string" in="context.reqestpath.toString()"/>
							<parameter name="method" type="string" in="context.method.toString()"/>
							<parameter name="eventdata" type="string" in="context.eventdata.toString()"/>
						</parameters>
					</function>
					<log><![CDATA[Don't have the HandleAPI for requestpath= <%=context.reqestpath.toString()%>]]></log>
				</function>
			</else>
		</if>
	</function>
</starosxml>